<!DOCTYPE html><html lang="en"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<title>Current Inventory</title><meta name="theme-color" content="#0ea5e9"/>
<style>
:root{--bg:#f6f7fb;--card:#fff;--text:#0f172a;--muted:#475569;--line:#e2e8f0;--radius:16px;--gap:12px;--shadow:0 8px 24px rgba(15,23,42,.06);--card-min-h:auto}
*{box-sizing:border-box}body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
header{position:sticky;top:0;z-index:10;background:#fff;border-bottom:1px solid var(--line)}
.wrap{max-width:620px;margin:0 auto;padding:12px}
h1{font-size:18px;margin:6px 0}.btns{display:flex;gap:8px;flex-wrap:wrap}
button{height:36px;padding:0 12px;border:1px solid var(--line);background:#fff;border-radius:12px;cursor:pointer}
main{padding:12px}.list{display:grid;grid-template-columns:1fr;gap:var(--gap)}
.card{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden;min-height:var(--card-min-h);display:flex;flex-direction:column}
.photo{width:100%;aspect-ratio:4/3;background:#e5e7eb}.photo img{width:100%;height:100%;object-fit:cover;display:block}
.info{padding:10px 12px 12px;display:flex;flex-direction:column;gap:6px}
.line{display:flex;align-items:baseline;justify-content:space-between;gap:10px;white-space:nowrap;overflow:hidden}
.title{font-weight:600;overflow:hidden;text-overflow:ellipsis}.miles{color:var(--muted);font-variant-numeric:tabular-nums}
.price{font-weight:700;font-variant-numeric:tabular-nums}.muted{color:var(--muted)}
body.snapshot header .btns{display:none}
</style></head><body>
<header><div class="wrap" style="display:flex;align-items:center;justify-content:space-between;gap:8px;">
<h1>Current Inventory</h1><div class="btns"><button id="snapshotBtn">Snapshot</button></div></div></header>
<main><div class="wrap"><div id="list" class="list"></div><p id="empty" class="muted" style="text-align:center;margin-top:24px;display:none;">No inventory yet.</p></div></main>
<script>
const list=document.getElementById('list'),empty=document.getElementById('empty'),snapshotBtn=document.getElementById('snapshotBtn');
function fmtPrice(n){try{return new Intl.NumberFormat('en-US',{style:'currency',currency:'USD',maximumFractionDigits:0}).format(n)}catch{return'$'+(n||0)}}
function fmtMiles(n){try{return new Intl.NumberFormat('en-US').format(n)+' mi'}catch{return(n||0)+' mi'}}
function render(items){list.innerHTML='';if(!items||!items.length){empty.style.display='block';return}else empty.style.display='none';
items.sort((a,b)=>(a.addedAt||0)-(b.addedAt||0)||(a.year||0)-(b.year||0));
items.forEach(c=>{const card=document.createElement('div');card.className='card';
const ph=document.createElement('div');ph.className='photo';const img=document.createElement('img');img.src=c.photo||placeholder();img.alt=c.model;ph.appendChild(img);
const info=document.createElement('div');info.className='info';
const l1=document.createElement('div');l1.className='line';
const t=document.createElement('div');t.className='title';t.textContent=`${c.year||''} ${c.model||''} ${c.trim||''}`.replace(/\s+/g,' ').trim();
const m=document.createElement('div');m.className='miles';m.textContent=fmtMiles(c.mileage||0);l1.appendChild(t);l1.appendChild(m);
const l2=document.createElement('div');l2.className='line';l2.innerHTML=`<b class='price'>${fmtPrice(c.price||0)}</b><span class='muted' style='font-size:12px;'>${c.addedAt? new Date(c.addedAt).toLocaleDateString():''}</span>`;
info.appendChild(l1);info.appendChild(l2);card.appendChild(ph);card.appendChild(info);list.appendChild(card)});adjustSnapshotHeights()}
function placeholder(){const s=`<svg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'><rect width='800' height='600' fill='#e5e7eb'/><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' fill='#94a3b8' font-family='system-ui' font-size='28'>Photo</text></svg>`;return'data:image/svg+xml;charset=utf-8,'+encodeURIComponent(s)}
async function load(){try{const res=await fetch('./inventory.json?ts='+Date.now(),{cache:'no-store'});if(!res.ok)throw 0;const data=await res.json();render(Array.isArray(data)?data:[])}catch(e){document.body.innerHTML='<div style="padding:16px;font-family:system-ui"><h3>Can\\'t load inventory.json</h3><p style="color:#475569">Check that the file exists in the repo root and is valid JSON.</p></div>';}}
function adjustSnapshotHeights(){if(!document.body.classList.contains('snapshot')){document.documentElement.style.setProperty('--card-min-h','auto');return}
const header=document.querySelector('header');const wrapPad=12*2;const gap=12*2;const vh=window.innerHeight;const headerH=header.offsetHeight;const available=vh-headerH-wrapPad-gap-8;const each=Math.max(160,Math.floor(available/3));document.documentElement.style.setProperty('--card-min-h',each+'px')}
document.getElementById('snapshotBtn').addEventListener('click',()=>{document.body.classList.toggle('snapshot');adjustSnapshotHeights();window.scrollTo({top:0,behavior:'instant'})});
window.addEventListener('resize',()=>{if(document.body.classList.contains('snapshot'))adjustSnapshotHeights()});
load();
</script></body></html>
